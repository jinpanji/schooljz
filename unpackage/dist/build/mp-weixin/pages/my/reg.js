(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/reg"],{"0a58":function(e,t,o){"use strict";var s=o("1c25"),i=o.n(s);i.a},"1c25":function(e,t,o){},4292:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,i=function(){Promise.all([o.e("common/vendor"),o.e("components/common/simple-address/simple-address")]).then(function(){return resolve(o("ca30"))}.bind(null,o)).catch(o.oe)},n=function(){o.e("components/common/xfl-select/xfl-select").then(function(){return resolve(o("ac88"))}.bind(null,o)).catch(o.oe)},c=o("57eb"),a={data:function(){return{btnStr:"获取验证码",codeFlag:!0,cityPickerValueDefault:[0,0,1],pickerText:"",addressList:[],codeList:[],userName:"",phone:"",regCode:"",address:"",avatar:"",openId:"",streetNmae:"",streetId:null,communityList:[],communiStr:[],isPhoneReg:!1,debug:""}},components:{simpleAddress:i,xflSelect:n},onLoad:function(e){s=new c({key:"SX7BZ-DJI6G-G5OQK-IDBI4-RZ6TO-33FBA"}),e.phone?(this.phone=e.phone,this.isPhoneReg=!0):(this.avatar=e.avatar,this.openId=e.openid,this.isPhoneReg=!1)},onShow:function(){var t=this,o=this;e.getLocation({success:function(e){console.log(e);var i=e.latitude,n=e.longitude;t.debug="获取经纬度",s.reverseGeocoder({location:{latitude:i,longitude:n},success:function(e){o.debug="获取城市地质成功";var t=e.result.address_component;o.addressList[0]=t.province,o.addressList[1]=t.city,o.addressList[2]=t.district,o.getDwCode()},fail:function(e){o.debug="获取中文位置失败"+JSON.stringify(e),console.log(e)},complete:function(e){}})}})},methods:{getDwCode:function(){var e=this.$refs.simpleAddress.queryIndex(this.addressList,"label");console.log(e);var t=e.data;this.codeList[0]=t.province.value,this.codeList[1]=t.city.value,this.codeList[2]=t.area.value,this.getCommunity(),console.log(this.codeList)},openAddres2:function(){var e=this.$refs.simpleAddress.queryIndex(this.addressList,"label");console.log(e),this.cityPickerValueDefault=e.index,this.$refs.simpleAddress.open()},onConfirm:function(e){this.pickerText=JSON.stringify(e),console.log("这呃呃呃呃呃呃"),console.log(e),this.addressList=e.labelArr,this.codeList[0]=e.provinceCode,this.codeList[1]=e.cityCode,this.codeList[2]=e.areaCode,console.log(this.codeList),this.getCommunity()},login:function(){var t=this;console.log("注册"),this.phone&&this.address&&this.userName?this.isPhoneReg?this.submitInfo():this.$http.post("puparent/verification",{phone:this.phone,code:this.regCode}).then((function(o){100==o.code?t.submitInfo():250==o.code&&e.showToast({icon:"none",title:o.msg})})):e.showToast({icon:"none",title:"请填写完整的信息！"})},submitInfo:function(){this.$http.post("puparent/register",{wechatOpenid:this.openId,photo:this.avatar,detailAddreee:this.address,name:this.userName,phone:this.phone,relation:"",provinceCode:this.codeList[0],provinceName:this.addressList[0],cityCode:this.codeList[1],cityName:this.addressList[1],areaCode:this.codeList[2],areaName:this.addressList[2],streetNmae:this.streetNmae,streetId:this.streetId}).then((function(t){if(100==t.code){var o=t.info;o=JSON.stringify(o),e.setStorageSync("userinfo",o),e.showToast({icon:"none",title:"注册成功，请前去登录！"}),setTimeout((function(){e.navigateBack({})}),2e3)}else e.showToast({icon:"none",title:t.msg})}))},getCodenum:function(){var t=this;console.log("获取验证码"),this.codeFlag&&(console.log("验证"),console.log(/^1[3456789]\d{9}$/.test(this.phone)),/^1[3456789]\d{9}$/.test(this.phone)||(this.codeFlag=!1,e.showToast({icon:"none",title:"请输入正确的手机号码！"}))),this.codeFlag?(this.codeFlag=!1,e.showLoading({icon:"loading",title:"正在发送！"}),this.$http.post("puparent/produceCode",{phone:this.phone}).then((function(o){if(e.hideLoading(),100==o.code){e.showLoading({icon:"success",title:"发送成功！",success:function(){setTimeout((function(){e.hideLoading()}),2e3)}});var s=null,i=60;s=setInterval((function(){t.btnStr=i+"s后重新获取",i--,0==i&&(clearInterval(s),t.codeFlag=!0,t.btnStr="获取验证码")}),1e3)}else e.hideLoading(),e.showToast({icon:"none",title:"发送验证码失败！"}),t.codeFlag=!0}))):/^1[3456789]\d{9}$/.test(this.phone)?e.showToast({title:"正在获取，请稍后！",icon:"none"}):this.codeFlag=!0},getCommunity:function(){var e=this;this.$http.post("mgStreet/simpleList",{provinceName:this.addressList[0],provinceCode:this.codeList[0],cityName:this.addressList[1],cityCode:this.codeList[1],areaName:this.addressList[2],areaCode:this.codeList[2],name:""}).then((function(t){if(100==t.code){var o=t.info;e.communiStr=[],e.communityList=[],o.forEach((function(t,o){e.communityList.push(t),e.communiStr.push(t.name)}))}}))},selectChange:function(e){console.log(e),this.streetNmae=e.newVal,this.streetId=this.communityList[e.index].id}}};t.default=a}).call(this,o("543d")["default"])},"64c1":function(e,t,o){"use strict";var s,i=function(){var e=this,t=e.$createElement;e._self._c},n=[];o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return n})),o.d(t,"a",(function(){return s}))},8418:function(e,t,o){"use strict";(function(e){o("83be");s(o("66fd"));var t=s(o("c0b0"));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},c0b0:function(e,t,o){"use strict";o.r(t);var s=o("64c1"),i=o("e127");for(var n in i)"default"!==n&&function(e){o.d(t,e,(function(){return i[e]}))}(n);o("0a58");var c,a=o("f0c5"),d=Object(a["a"])(i["default"],s["b"],s["c"],!1,null,"41ed9124",null,!1,s["a"],c);t["default"]=d.exports},e127:function(e,t,o){"use strict";o.r(t);var s=o("4292"),i=o.n(s);for(var n in s)"default"!==n&&function(e){o.d(t,e,(function(){return s[e]}))}(n);t["default"]=i.a}},[["8418","common/runtime","common/vendor"]]]);