(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/msg/userinfo"],{"1f62":function(e,t,n){"use strict";n.r(t);var o=n("dfd3"),s=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=s.a},4174:function(e,t,n){"use strict";n.r(t);var o=n("da52"),s=n("1f62");for(var i in s)"default"!==i&&function(e){n.d(t,e,(function(){return s[e]}))}(i);n("f8d7");var a,c=n("f0c5"),r=Object(c["a"])(s["default"],o["b"],o["c"],!1,null,"5c3de658",null,!1,o["a"],a);t["default"]=r.exports},"4d08":function(e,t,n){"use strict";(function(e){n("83be");o(n("66fd"));var t=o(n("4174"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},abfb:function(e,t,n){},da52:function(e,t,n){"use strict";var o,s=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}))},dfd3:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){Promise.all([n.e("common/vendor"),n.e("components/common/simple-address/simple-address")]).then(function(){return resolve(n("ca30"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("components/common/xfl-select/xfl-select").then(function(){return resolve(n("ac88"))}.bind(null,n)).catch(n.oe)};function i(e){var t=new Date,n=t.getFullYear(),o=t.getMonth()+1,s=t.getDate();return"start"===e?n-=60:"end"===e&&(n+=2),o=o>9?o:"0"+o,s=s>9?s:"0"+s,"".concat(n,"-").concat(o,"-").concat(s)}var a={components:{simpleAddress:o,xflSelect:s},data:function(){return{xblist:["男","女"],xbcheck:0,date:i({format:!0}),startDate:i("start"),endDate:i("end"),userId:null,userInfo:{},imgUrl:"",photo:"",cityPickerValueDefault:[0,0,1],addressList:[],codeList:[],pickerText:"",gxlist:["父亲","母亲","爷爷","奶奶","叔叔","阿姨"],gxcheck:0,btnStr:"获取验证码",codeFlag:!0,regCode:"",streetNmae:"",streetId:null,communityList:[],communiStr:[]}},onLoad:function(t){console.log(t.id),this.imgUrl=this.$imgurl,this.userId=t.id;var n=e.getStorageSync("userInfo");n=JSON.parse(n),this.photo=n.photo,this.getUserInfo()},created:function(){},onShow:function(){},methods:{logOut:function(){e.removeStorageSync("userInfo"),e.navigateTo({url:"../../pages/my/login"})},getDwCode:function(){var e=this.$refs.simpleAddress.queryIndex(this.addressList,"label");console.log(e);var t=e.data;this.codeList[0]=t.province.value,this.codeList[1]=t.city.value,this.codeList[2]=t.area.value,this.getCommunity(),console.log(this.codeList)},openAddres2:function(){var e=this.$refs.simpleAddress.queryIndex(this.addressList,"label");console.log(e),this.cityPickerValueDefault=e.index,this.$refs.simpleAddress.open()},onConfirm:function(e){this.pickerText=JSON.stringify(e),console.log("这呃呃呃呃呃呃"),console.log(e),this.addressList=e.labelArr,this.codeList[0]=e.provinceCode,this.codeList[1]=e.cityCode,this.codeList[2]=e.areaCode,this.getCommunity(),console.log(this.codeList)},xbchange:function(e){console.log(e)},gxchange:function(e){console.log(e),this.userInfo.relation=this.gxlist[e.detail.value],this.gxcheck=e.detail.value,console.log(this.userInfo.relation)},bindDateChange:function(e){this.date=e.detail.value},bindTimeChange:function(e){this.time=e.detail.value},getUserInfo:function(){var e=this;this.$http.post("puparent/detail",{parentId:this.userId}).then((function(t){if(100==t.code){e.userInfo=t.info;var n=t.info;e.addressList[0]=n.province.name,e.addressList[1]=n.city.name,e.addressList[2]=n.area.name,e.getDwCode();var o=0;n.relation&&(o=e.gxlist.indexOf(n.relation)),e.gxcheck=-1==o?0:o,e.streetId=n.streetId,e.streetNmae=n.streetNmae}}))},getCodenum:function(){var t=this;console.log("获取验证码"),this.codeFlag&&(console.log("验证"),console.log(/^1[3456789]\d{9}$/.test(this.userInfo.phone)),/^1[3456789]\d{9}$/.test(this.userInfo.phone)||(this.codeFlag=!1,e.showToast({icon:"none",title:"请输入正确的手机号码！"}))),this.codeFlag?(this.codeFlag=!1,e.showLoading({icon:"loading",title:"正在发送！"}),this.$http.post("puparent/produceCode",{phone:this.userInfo.phone}).then((function(n){if(e.hideLoading(),100==n.code){e.showLoading({icon:"success",title:"发送成功！",success:function(){setTimeout((function(){e.hideLoading()}),2e3)}});var o=null,s=60;o=setInterval((function(){t.btnStr=s+"s后重新获取",s--,0==s&&(clearInterval(o),t.codeFlag=!0,t.btnStr="获取验证码")}),1e3)}else e.hideLoading(),e.showToast({icon:"none",title:"发送验证码失败！"}),t.codeFlag=!0}))):/^1[3456789]\d{9}$/.test(this.phone)?e.showToast({title:"正在获取，请稍后！",icon:"none"}):this.codeFlag=!0},update:function(){var t=this;this.regCode?this.$http.post("puparent/verification",{phone:this.userInfo.phone,code:this.regCode}).then((function(n){100==n.code?t.submitInfo():e.showToast({icon:"none",title:n.msg})})):e.showToast({icon:"none",title:"请输入验证码"})},submitInfo:function(){var t=this;console.log("提交"),this.$http.post("puparent/update",{id:this.userInfo.id,phone:this.userInfo.phone,name:this.userInfo.name,relation:this.gxlist[this.gxcheck],detailAddreee:this.userInfo.detailAddreee,streetId:this.streetId,streetNmae:this.streetNmae,province:{code:this.codeList[0],name:this.addressList[0]},city:{code:this.codeList[1],name:this.addressList[1]},area:{code:this.codeList[2],name:this.addressList[2]}},"application/json").then((function(n){if(100==n.code){e.showToast({icon:"success",title:"修改成功"});var o=e.getStorageSync("userInfo");o=JSON.parse(o),o.name=t.userInfo.name,o=JSON.stringify(o),e.setStorageSync("userInfo",o),setTimeout((function(){e.navigateBack({})}),2e3)}}))},getCommunity:function(){var e=this;this.$http.post("mgStreet/simpleList",{provinceName:this.addressList[0],provinceCode:this.codeList[0],cityName:this.addressList[1],cityCode:this.codeList[1],areaName:this.addressList[2],areaCode:this.codeList[2],name:""}).then((function(t){if(100==t.code){var n=t.info;e.communiStr=[],e.communityList=[],n.forEach((function(t,n){e.communityList.push(t),e.communiStr.push(t.name)}))}}))},selectChange:function(e){console.log(e),this.streetNmae=e.newVal,this.streetId=this.communityList[e.index].id}}};t.default=a}).call(this,n("543d")["default"])},f8d7:function(e,t,n){"use strict";var o=n("abfb"),s=n.n(o);s.a}},[["4d08","common/runtime","common/vendor"]]]);